var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,i=0,a=arguments.length;i<a;i++)e+=arguments[i].length;var t=Array(e),l=0;for(i=0;i<a;i++)for(var n=arguments[i],r=0,o=n.length;r<o;r++,l++)t[l]=n[r];return t};!function(c){"use strict";var l="#fw-wizard-container",a="#fw-elements-container",t="color: white; background-color: purple; padding: 3px; display: block; line-height: 25px; border-radius: 2px;";function n(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];window.console&&console.log.apply(console,__spreadArrays(["%cMSF",t],e))}function r(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];window.console&&console.warn.apply(console,__spreadArrays(["%cMSF",t],e))}function o(e,i){c('<div id="fw-alert" style="background-color:'+(i?"#4caf50":"#f44336")+'">'+e+"</div>").hide().appendTo("#wpbody-content").slideDown().delay(3e3).slideUp()}function s(e){return(""+e).replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"\\'")}function d(e,i){var a='<div class="fw-radio-option-element" data-type="option">';return a+='<input type="text" class="fw-radio-option" placeholder="'+wizard.i18n.radio.option+" "+i+'" value="'+s(e)+'"></input>',a+='<div class="fw-remove-radio-option"><i class="fa fa-minus-circle" aria-hidden="true"></i></div></div>'}function f(e){var i='<div class="fw-step-block" data-type="'+e.type+'" >';switch(i+='<div class="fw-block-controls">',i+='<i class="fa fa-remove fw-remove-block" title="'+wizard.i18n.tooltips.removeBlock+'" aria-hidden="true"></i>',i+='<i class="fa fa-caret-up fw-toggle-block" aria-hidden="true"></i>',i+="</div>",i+=function(e){var i='<div class="fw-block-action fw-block-hndle">';return i+='<i class="fa fa-arrows fw-move-block fw-block-hndle" aria-hidden="true"></i>',i+="<h4>"+e+"</h4>",i+="</div>"}(e.type),i+='<div class="fw-block-fields">',e.type){case"radio":e.elements||(e.elements=[{type:"header",value:""},{type:"option",value:""}]),i+=function(e){var i,a,t,l,n,r=0,o="";for(o+='<div class="fw-radio-option-container">',i=0,a=e.elements.length;i<a;i++)"option"===(t=e.elements[i]).type?(1==i&&(o+="<label>"+wizard.i18n.radio.options+"</label>"),o+=d(t.value,1+r++)):o+=(l=t.value,n=void 0,n='<div class="fw-radio-option-element" data-type="header"><label>'+wizard.i18n.label+"</label>",n+='<input type="text" class="fw-radio-header fw-block-label" value="'+l+'"></input>',n+="</div>");return o+="</div>",o+='<button class="fw-radio-add"><i class="fa fa-plus" aria-hidden="true"></i> '+wizard.i18n.radio.addOption+"</button><br/>",o+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/> "+wizard.i18n.required+"</label>","true"==e.multichoice?o+='<label><input type="checkbox" class="fw-radio-multichoice" checked/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>':o+='<label><input type="checkbox" class="fw-radio-multichoice"/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>',o}(e);break;case"select":e.elements||(e.elements=[]),i+=function(e){var i=0,a="",t=wizard.i18n.select.placeholder?wizard.i18n.select.placeholder:"";for(a+='<div class="fw-select-option-container">',a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-block-label" value="'+e.label+'"></input>',a+="<label>"+t+"</label>",a+='<input type="text" class="fw-select-placeholder" value="'+e.placeholder+'"></input>',a+="<label>"+wizard.i18n.select.options+"</label>",a+='<textarea class="fw-select-options" rows="4" cols="50">',i=0;i<e.elements.length;i++)a+=e.elements[i]+"\n";return a+="</textarea>",a+="</div>",a+='<label><input type="checkbox" class="fw-select-search"'+z(e.search)+"/>"+wizard.i18n.select.search+"</label>",a+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/> "+wizard.i18n.required+"</label>"}(e);break;case"checkbox":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"text":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"email":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>",i+='<label><input type="checkbox" class="fw-email-confirm"'+z(e.confirm)+"/>"+wizard.i18n.email.confirm+"</label>"}(e);break;case"get-variable":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+="<label>"+wizard.i18n.get_var.get_param+"</label>",i+='<input type="text" class="fw-get-var-get-param fw-block-label" value="'+(e.get_param?e.get_param:"")+'"></input><br/>'}(e);break;case"numeric":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>",i+="<label>"+wizard.i18n.numeric.minimum+"</label>",i+='<input type="text" class="fw-numeric-minimum fw-block-label" placeholder="'+wizard.i18n.numeric.no_minimum+'" value="'+(e.minimum?e.minimum:"")+'" pattern="-?\\d*"></input><br/><br/>',i+="<label>"+wizard.i18n.numeric.maximum+"</label>",i+='<input type="text" class="fw-numeric-maximum fw-block-label" placeholder="'+wizard.i18n.numeric.no_maximum+'" value="'+(e.maximum?e.maximum:"")+'" pattern="-?\\d*"></input><br/>'}(e);break;case"file":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-file-multi"'+z(e.multi)+"/>"+wizard.i18n.multifile+"</label>",i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"date":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+="<label>"+wizard.i18n.dateformat+'<a target="_blank" href="http://t1m0n.name/air-datepicker/docs/#sub-section-9"><i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.dateformat+'"></i></a></label>',i+='<input type="text" class="fw-date-format fw-block-label" placeholder="'+wizard.i18n.dateformat+'" value="'+(e.format?e.format:"yy-mm-dd")+'" ></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"textarea":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-textarea-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"paragraph":i+=function(e){var i="";return i+="<label>"+wizard.i18n.paragraph.textHtml+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.paragraph+'"></i></label>',i+='<textarea class="fw-paragraph-text fw-block-label" placeholder="'+wizard.i18n.paragraph.text+'">'+(e.text?e.text:"")+"</textarea>",i+='<label style="display:none;"><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"media":i+=function(e){var i="";return i+="<label>"+wizard.i18n.media.title+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.media.tooltip+'"></i></label>',i+='<div style="float:left; width: 49%;"><label>'+wizard.i18n.media.file_title+"</label>",i+='<input style="width: 90%" type="text" disabled class="fw-media-element-title fw-block-label" value=""></input><br/></div>',i+='<div style="float: left; width: 49%;"><label>'+wizard.i18n.media.file_name+"</label>",i+='<input style="width: 90%" type="text" disabled class="fw-media-element-filename fw-block-label" value=""></input><br/></div>',i+='<br style="clear: both;" />',i+="<label>"+wizard.i18n.media.preview+"</label>",i+='<div class="fw-media-preview-wrapper"><img class="fw-media-preview" src="" height="100" style="height: 100px; width: auto; max-width: 100%;"></div>',i+='<input type="hidden" name="fw-media-element" class="fw-media-element" value="'+(e.attachmentId?e.attachmentId:0)+'" class="regular-text" />',i+='<input type="button" class="button-primary fw-media-select" value="'+wizard.i18n.media.select+'"/><br /><br />',i+='<label style="display:none;"><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"regex":i+=function(e){var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+="<label>"+wizard.i18n.filter+"</label>",i+='<input type="text" class="fw-regex-filter fw-block-label" placeholder="'+wizard.i18n.filter+'" value="'+(e.filter?e.filter:"")+'"></input><br/>',i+="<label>"+wizard.i18n.filterError+"</label>",i+='<input type="text" class="fw-regex-error fw-block-label" placeholder="'+wizard.i18n.filterError+'" value="'+(e.customError?e.customError:"")+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+z(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"registration":i+=function(e){var i="";return i+='<p class="msfp-registration-info">'+wizard.i18n.registration.info+"</p>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-email" checked disabled="disabled"/>'+wizard.i18n.registration.email+"</label>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-username" checked disabled="disabled"/>'+wizard.i18n.registration.username+"</label>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-password"'+z(e.password)+"/>"+wizard.i18n.registration.password+"</label>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-firstname"'+z(e.firstname)+"/>"+wizard.i18n.registration.firstname+"</label>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-lastname"'+z(e.lastname)+"/>"+wizard.i18n.registration.lastname+"</label>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-website"'+z(e.website)+"/>"+wizard.i18n.registration.website+"</label>",i+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-bio"'+z(e.bio)+"/>"+wizard.i18n.registration.bio+"</label>"}(e)}return i+="</div>",i+='<div class="fw-clearfix"></div>',i+="</div>"}function p(e,i){n("part",e);var a='<div class="'+i+'">';return a+='<div class="fw-section-hndle"><i class="fa fa-arrows"></i></div>',a+='<input type="text" class="fw-part-title" value="'+e.title+'" placeholder="'+wizard.i18n.partTitle+'"></input>',a+='<div class="fw-remove-part" title="'+wizard.i18n.removeSection+'">',a+='<i class="fa fa-remove"></i>',a+='</div><div class="inside connectedSortable">',a+=function(e){for(var i="",a=e.length,t=0;t<a;t++)if("conditional"==e[t].type){i+=f(e[t].block);var l={prec_block_id:e[t].prec_block_id,prec_operator:e[t].prec_operator,prec_value:e[t].prec_value,visible:e[t].visible};i=i.slice(0,-6),i+='<input class="msf-block-meta" name="msf-block-meta-'+t+'" type="hidden" value="'+encodeURI(JSON.stringify(l))+'">',i+="</div>"}else i+=f(e[t]);return i}(e.blocks),a+='</div><div class="fw-add-element">',a+='<a href="#TB_inline?width=400&height=200&inlineId=fw-thickbox-content" class="thickbox"><i class="fa fa-plus"></i> '+wizard.i18n.addElement+"</a>",a+="</div>",a+="</div>"}function u(e,i){var a="fw-headline-"+i,t="fw-copy-text-"+i,l='<div class="fw-step"><div class="form-wrap">';return l+='<div class="input form-field">',l+='<label for="'+("fw-title-"+i)+'"><b>'+wizard.i18n.title+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.title+'"></i></label>',l+='<input type="text" class="fw-step-title" value="'+e.title+'"></input>',l+="</div>",l+='<div class="input form-field">',l+='<label for="'+a+'"><b>'+wizard.i18n.headline+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.headline+'"></i></label>',l+='<input type="text" class="fw-step-headline" value="'+e.headline+'"></input>',l+="</div>",l+='<div class="input form-field">',l+='<label for="'+t+'"><b>'+wizard.i18n.copyText+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.copyText+'"></i></label>',l+='<input type="text" class="fw-step-copy_text" value="'+e.copy_text+'"></input>',l+="</div>",l+='<div class="fw-step-parts">'+function(e){var i=e.length,a='<div><div class="fw-parts-header"><h3>'+wizard.i18n.sections+"</h3></div>";a+='<div class="fw-column-buttons">',a+='<button type="button" class="fw-button-one-column"><i class="fa fa-align-justify"></i></button>',a+='<button type="button" class="fw-button-two-columns"><i class="fa fa-align-justify"></i> <i class="fa fa-align-justify"></i></button>',a+="</div>",a+='<div class="fw-parts-container">';for(var t=0;t<i;t++)a+=p(e[t],"fw-step-part");return a+="</div>",a+='<div class="fw-parts-footer">',a+='<a class="fw-add-part"><i class="fa fa-plus"></i> '+wizard.i18n.addSection+"</a>",a+="</div>",a+="</div>"}(e.parts)+"</div>",l+='</div><div class="fw-clearfix"></div></div>'}function b(e,i){var a='<div class="postbox">';return a+='<div class="fw-movediv hndle ui-sortable-handle"><i class="fa fa-arrows"></i></div>',a+='<h1 class="fw-step-h1 hndle ui-sortable-handle"><span>',a+=e.title+"</span></h1>",a+='<div class="fw-step-controls">',a+='<i class="fa fa-remove fw-remove-step" title="'+wizard.i18n.tooltips.removeStep+'" aria-hidden="true"></i>',a+='<i class="fa fa-caret-up fw-toggle-step" aria-hidden="true"></i>',a+='<i class="fa fa-files-o fw-duplicate-step" title="duplicate step" aria-hidden="true"></i>',a+="</div>",a+='<div class="fw-clearfix"></div>',a+=u(e,i),a+='<div class="fw-clearfix"></div>',a+="</div>"}function w(e){var i={};switch(i.type=e.attr("data-type")){case"radio":!function(e,i){var a=i.elements=[];e.find(".fw-radio-option-element").each(function(e,i){a.push(function(e){var i={type:e.attr("data-type"),value:null};return"option"===i.type?i.value=e.find(".fw-radio-option").val():"header"===i.type&&(i.value=e.find(".fw-radio-header").val()),i}(c(i)))}),i.required=e.find(".fw-required").prop("checked"),i.multichoice=e.find(".fw-radio-multichoice").prop("checked")}(e,i);break;case"select":!function(e,i){var a=e.find(".fw-select-options").val().split("\n");i.required=e.find(".fw-required").prop("checked"),i.search=e.find(".fw-select-search").prop("checked"),i.label=e.find(".fw-block-label").val(),i.placeholder=e.find(".fw-select-placeholder").val(),i.elements=a.filter(function(e){return""!==e&&" "!==e})}(e,i);break;case"checkbox":!function(e,i){i.label=e.find(".fw-text-label").val(),i.required=e.find(".fw-required").prop("checked")}(e,i);break;case"text":!function(e,i){i.label=e.find(".fw-text-label").val(),i.required=e.find(".fw-required").prop("checked")}(e,i);break;case"email":!function(e,i){i.label=e.find(".fw-text-label").val(),i.required=e.find(".fw-required").prop("checked"),i.confirm=e.find(".fw-email-confirm").prop("checked")}(e,i);break;case"get-variable":!function(e,i){i.label=e.find(".fw-text-label").val(),i.get_param=e.find(".fw-get-var-get-param").val()}(e,i);break;case"numeric":!function(e,i){i.label=e.find(".fw-text-label").val(),i.required=e.find(".fw-required").prop("checked"),i.minimum=e.find(".fw-numeric-minimum").val(),i.maximum=e.find(".fw-numeric-maximum").val()}(e,i);break;case"file":!function(e,i){i.label=e.find(".fw-text-label").val(),i.required=e.find(".fw-required").prop("checked"),i.multi=e.find(".fw-file-multi").prop("checked")}(e,i);break;case"date":!function(e,i){i.label=e.find(".fw-text-label").val(),i.format=e.find(".fw-date-format").val(),i.required=e.find(".fw-required").prop("checked")}(e,i);break;case"textarea":!function(e,i){i.label=e.find(".fw-textarea-label").val(),i.required=e.find(".fw-required").prop("checked")}(e,i);break;case"paragraph":!function(e,i){i.text=e.find(".fw-paragraph-text").val()}(e,i);break;case"media":!function(e,i){i.attachmentId=e.find(".fw-media-element").val()}(e,i);break;case"regex":!function(e,i){i.label=e.find(".fw-text-label").val(),i.filter=e.find(".fw-regex-filter").val(),i.customError=e.find(".fw-regex-error").val(),i.required=e.find(".fw-required").prop("checked")}(e,i);break;case"registration":!function(e,i){i.required=!1,i.password=e.find(".msfp-registration-password").prop("checked"),i.firstname=e.find(".msfp-registration-firstname").prop("checked"),i.lastname=e.find(".msfp-registration-lastname").prop("checked"),i.website=e.find(".msfp-registration-website").prop("checked"),i.bio=e.find(".msfp-registration-bio").prop("checked")}(e,i)}return i}function m(e){var i={};i.title=e.find(".fw-part-title").val();var t=i.blocks=[];return e.find(".fw-step-block").each(function(e,i){var a=c(i);a.find(".msfp-conditional").prop("checked")?t.push(function(e){var i={type:"conditional"};return i.visible=e.find(".msfp-conditional-visible").val(),i.prec_block_id=e.find(".msfp-conditional-prec-block-id").val(),i.prec_operator=e.find(".msfp-conditional-prec-op").val(),i.prec_value=e.find(".msfp-conditional-prec-value").val(),i.block=w(e),i}(a)):t.push(w(a))}),i}function v(e){var a={title:e.find(".fw-step-title").val(),headline:e.find(".fw-step-headline").val(),copy_text:e.find(".fw-step-copy_text").val(),parts:[]};return e.find(".fw-step-part").each(function(e,i){a.parts.push(m(c(i)))}),a}function i(e){var i=!0;return""===e.title?(i=!1,o(wizard.i18n.alerts.noFormTitle,!1)):i=function(e){for(var i=!0,a=0;a<e.length;a++)if(e[a].title)for(var t=0;t<e[a].parts.length;t++){""===e[a].parts[t].title&&(i=!1,o(wizard.i18n.alerts.noSectionTitle,!1));for(var l=0;l<e[a].parts[t].blocks.length;l++){var n=e[a].parts[t].blocks[l];void 0!==n.label&&""===n.label&&(i=!1,o(wizard.i18n.alerts.noBlockTitle,!1))}}else i=!1,o(wizard.i18n.alerts.noStepTitle,!1);return i}(e.wizard.steps)&&function(e){var i=!0;return function(e){return!!e&&/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}(e.to)?e.subject||(i=!1,c("#fw-nav-settings").trigger("click"),o(wizard.i18n.alerts.noSubject,!1)):(i=!1,c("#fw-nav-settings").trigger("click"),o(wizard.i18n.alerts.invalidEmail,!1)),i}(e.wizard.settings),i}function h(){var e=c(l),a={wizard:{title:c(".fw-wizard-title").val(),steps:[],settings:{thankyou:c(".fw-settings-thankyou").val(),to:c(".fw-mail-to").val(),frommail:c(".fw-mail-from-mail").val(),fromname:c(".fw-mail-from-name").val(),subject:c(".fw-mail-subject").val(),header:c(".fw-mail-header").val(),headers:c(".fw-mail-headers").val(),replyto:c(".fw-mail-replyto").val(),usercopy:c(".fw-mail-usercopy").val(),optin:c(".fw-mail-optin").val(),optin_success:c(".fw-mail-optin-success").val(),replacements:c(".fw-mail-string-replacement").prop("checked")?"on":"off"}}},t=e.find(".fw-step");if(t.each(function(e,i){t.length;a.wizard.steps.push(v(c(i)))}),a.wizard.steps.push(),i(a)){n("Save",a),c.ajax({type:"POST",url:wizard.ajaxurl,dataType:"json",data:{action:"fw_wizard_save",data:JSON.stringify(a,function(e,i){return"boolean"==typeof i?String(i):i}),nonce:wizard.nonce,id:wizard.id},success:function(e){void 0!==e.data.nonce&&(wizard.nonce=e.data.nonce),wizard.id=e.data.id,o(e.data.msg,e.success)},error:function(e){r("Fail",arguments),r("Response",e),o(wizard.i18n.alerts.ajaxSendError,!1)}})}}function k(){c(".meta-box-sortables").sortable({opacity:.6,revert:!0,cursor:"move",handle:".hndle",tolerance:"pointer",placeholder:"fw-block-placeholder",start:function(e,i){var a=c(i.item).height();c(".fw-block-placeholder").height(a)},update:function(e,i){r("sortables update",e,i),c(i.item).removeAttr("style"),k(),g()}}),c(".fw-step-part .inside").sortable({opacity:.6,cursor:"move",connectWith:".connectedSortable",handle:".fw-block-hndle",tolerance:"intersect",placeholder:"fw-block-placeholder",revert:100,start:function(e,i){var a=c(i.item).height(),t=c(".fw-block-placholder");t.height(a),t.attr("data-type",i.item.attr("data-type"))},update:function(e,i){var a=c(i.item).attr("data-type"),t=-1;if(c(i.item).is(".fw-draggable-block"))if("registration"===a&&_())o(wizard.i18n.alerts.onlyOneRegistration,!1),c(i.item).remove();else{var l=c(f({type:a,label:""}));c(i.item).replaceWith(l),n("New block: ",l+" "+(t=c(".fw-step-block").index(l)))}k(),g(),E(),msfp&&setupConditionals(t)}}),c(".fw-parts-container").sortable({opacity:.6,cursor:"move",connectWith:".fw-parts-container",handle:".fw-section-hndle",tolerance:"intersect",placeholder:"fw-section-placeholder",revert:100,start:function(e,i){var a=c(i.item).height();c(".fw-section-placeholder").height(a)},update:function(e,i){k(),g(),E()}}),c(a+" .fw-draggable-block").draggable({connectToSortable:".fw-step-part .inside",revert:"invalid",helper:"clone",cursor:"move"}),c(l).find(".fw-step-title").on("change input",e)}function g(){c(".fa-info-circle").tooltip(),c(".fw-remove-step").tooltip(),c(".fw-duplicate-step").tooltip(),c(".fw-remove-part").tooltip(),c(".fw-remove-block").tooltip(),c(".hndle.ui-sortable-handle").tooltip()}function e(e){var i=c(this);n("titleOnChangeU",i.val()),i.closest(".postbox").find("h1 > span").html(i.val().toString())}function y(e){e.find('.fw-radio-option-element[data-type="option"] > label').each(function(e,i){n("updateOptions",i),c(i).html("Option "+(e+1))})}function x(e){var i=c(".fw-step").length;if(i<5||msfp)if(i<10){var a=c(b(e,i));a.appendTo(c(l).find(".meta-box-sortables")),E(),k(),S(),0<i&&c("html, body").animate({scrollTop:c(document).height()-a.height()-180},500)}else o(wizard.i18n.alerts.onlyTen,!1);else o(wizard.i18n.alerts.onlyFive,!1)}function z(e){var i="";return"true"===e&&(i="checked"),i}function _(){var a=!1;return c(".fw-step-block").each(function(e,i){"registration"==c(i).attr("data-type")&&(a=!0)}),a}function q(){var e=c(this).closest(".postbox");!0===confirm(wizard.i18n.alerts.reallyDeleteStep)&&e.slideUp(700,function(){e.remove()})}function C(e){var i=c(e.target).closest(".fw-step-part");!0===confirm(wizard.i18n.alerts.reallyDeleteSection)&&i.slideUp(500,function(){i.remove()})}function S(){c(".thickbox").click(function(t){c("#fw-thickbox-radio").unbind("click").click(function(e){tb_remove();var i=c(f({type:"radio"}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-select").unbind("click").click(function(e){tb_remove();var i=c(f({type:"select",label:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-text").unbind("click").click(function(e){tb_remove();var i=c(f({type:"text",label:"",value:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-email").unbind("click").click(function(e){tb_remove();var i=c(f({type:"email",label:"",value:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-get-variable").unbind("click").click(function(e){tb_remove();var i=c(f({type:"get-variable",label:"",value:"",get_param:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-numeric").unbind("click").click(function(e){tb_remove();var i=c(f({type:"numeric",label:"",value:"",minimum:"",maximum:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-file").unbind("click").click(function(e){tb_remove();var i=c(f({type:"file",label:"",value:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E()}),c("#fw-thickbox-textarea").unbind("click").click(function(e){tb_remove();var i=c(f({type:"textarea",label:"",value:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-date").unbind("click").click(function(e){tb_remove();var i=c(f({type:"date",label:"",format:"yy-mm-dd"}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),g(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-paragraph").unbind("click").click(function(e){tb_remove();var i=c(f({type:"paragraph",text:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),g(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-media").unbind("click").click(function(){tb_remove();var e=c(f({type:"media",attachmentId:0}));c(t.target).parents(".fw-step-part").find(".inside").append(e),E(),g(),msfp&&setupConditionals(c(".fw-step-block").index(e))}),c("#fw-thickbox-regex").unbind("click").click(function(e){tb_remove();var i=c(f({type:"regex",label:"",filter:"",customError:""}));c(t.target).parents(".fw-step-part").find(".inside").append(i),E(),msfp&&setupConditionals(c(".fw-step-block").index(i))}),c("#fw-thickbox-registration").unbind("click").click(function(e){tb_remove();var i=c(f({type:"registration",label:"",value:""})),a=c(t.target).parents(".fw-step-part");_()?o(wizard.i18n.alerts.onlyOneRegistration,!1):a.find(".inside").append(i),E()})})}function j(e){if(-1!=c("input[type=text]").index(c(e.target))){var i=c(e.target).val();Array.isArray(i)&&(i=i.join(" ")),i=i.toString(),(-1==c.inArray(e.keyCode,[37,38,39,40,48,49,50,51,52,53,54,55,56,57,58,96,97,98,99,100,101,102,103,104,105,8,13,189])||189==e.keyCode&&-1!=i.indexOf("-")||198==e.keyCode&&0!=i.length)&&e.preventDefault()}}function T(e,i){var a=i.url,t=i.title,l=i.filename;switch(i.type){case"image":i.sizes.thumbnail.url&&(a=i.sizes.thumbnail.url);break;case"video":i.thumb.src?a=i.thumb.src:i.icon&&(a=i.icon)}e.find(".fw-media-preview").attr("src",a),e.find(".fw-media-element").val(i.id),e.find(".fw-media-element-title").val(t),e.find(".fw-media-element-filename").val(l)}var O=null;function A(e){e.preventDefault();var i=c(e.target).parent();if(O)return O.msf_block=i,void O.open();(O=wp.media({title:wizard.i18n.media.frame_title,multiple:!1})).msf_block=i,O.on("close",function(){T(O.msf_block,O.state().get("selection").first().toJSON())}),O.on("open",function(){var e=O.msf_block,i=O.state().get("selection"),a=e.find(".fw-media-element").val(),t=wp.media.attachment(a);t.fetch(),i.add(t?[t]:[])}),O.open()}function E(){c(".fw-element-step").unbind("click").click(function(e){x({title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]})}),c(".fw-duplicate-step").unbind("click").click(function(e){!function(e){var i=v(e);i.title+=" (COPY)",x(i)}(c(this).parent().parent().find(".fw-step"))}),c(".fw-add-part").unbind("click").click(function(e){!function(e){var i=e.target,a=p({title:"",blocks:[]},"fw-step-part");c(i).closest(".fw-step-parts").find(".fw-parts-container").append(a),c(".fw-remove-part").click(function(e){C(e)}),S()}(e),k()}),c(".fw-toggle-step").unbind("click").click(function(e){c(this).parent().parent().find(".fw-step").slideToggle(),c(this).toggleClass("fw-icon-rotated")}),c(".fw-remove-part").unbind("click").click(function(e){C(e)}),c(".fw-remove-block").unbind("click").click(function(e){!function(e){var i=c(e.target).closest(".fw-step-block"),a=i.find(".fw-block-label").val();!0===confirm(wizard.i18n.alerts.reallyDeleteBlock+"\n\n"+a)&&i.slideUp(300,function(){i.remove()})}(e)}),c(".fw-toggle-block").unbind("click").click(function(e){var i=c(this).parent().parent();if(i.toggleClass("fw-block-collapsed"),i.hasClass("fw-block-collapsed")){var a=i.find(".fw-block-label").val();Array.isArray(a)&&(a=a.join(" ")),i.find("h4").text(a),c(this).addClass("fw-icon-rotated")}else{var t=i.data("type");i.find("h4").text(t),c(this).removeClass("fw-icon-rotated")}})}function D(e,a){var n=c(e),r=n.val(),o=!1;n.find("option").each(function(e,i){c(i).val()!==a&&i.remove()}),c(".fw-step-block").each(function(e,i){if("email"===c(i).attr("data-type")){var a=String(c(i).find(".fw-block-label").val()),t=s(a);if(!n.find("option[value='"+t+"']").length){r===t&&(o=!0);var l=new Option(a,t,!1,!1);n.append(l)}}}),o?n.val(r):n.val(a),n.trigger("change")}c(document).ready(function(){try{var e=JSON.parse(wizard.json),i=c(l);e.wizard.title?c(".fw-wizard-title").val(e.wizard.title):c(".fw-wizard-title").val("My Multi Step Form"),function(e){var i,a,t='<div class="postbox-container"><div class="metabox-holder"><div class="meta-box-sortables">';for(i=0,a=e.length;i<a;i++)t+=b(e[i],i);t+="</div>",t+='<a class="fw-element-step"><i class="fa fa-plus"></i> '+wizard.i18n.addStep+"</a>",t+="</div></div>",c(l).html(t)}(e.wizard.steps&&0<e.wizard.steps.length?e.wizard.steps:[{title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]}]),c(".fw-mail-replyto").select2({width:"60%"}),D(".fw-mail-replyto","no-reply"),c(".fw-mail-usercopy").select2({width:"60%"}),D(".fw-mail-usercopy","no-usercopy"),c(".fw-mail-optin").select2({width:"60%"}),D(".fw-mail-optin","no-optin"),function(e){if(e){if(e.thankyou&&c(".fw-settings-thankyou").val(e.thankyou),e.subject&&c(".fw-mail-subject").val(e.subject),e.to&&c(".fw-mail-to").val(e.to),e.frommail&&c(".fw-mail-from-mail").val(e.frommail),e.fromname&&c(".fw-mail-from-name").val(e.fromname),e.header&&c(".fw-mail-header").val(e.header),e.headers&&c(".fw-mail-headers").val(e.headers),e.replyto&&(c(".fw-mail-replyto").val(e.replyto),c(".fw-mail-replyto").trigger("change")),e.usercopy)c(".fw-mail-usercopy").val(e.usercopy),c(".fw-mail-usercopy").trigger("change");else if("on"===wizard.usedcc){var i=c(".fw-mail-usercopy").find("option");if(2<=i.length){var a=c(i[1]).val();c(".fw-mail-usercopy").val(a),c(".fw-mail-usercopy").trigger("change")}}e.optin&&(c(".fw-mail-optin").val(e.optin),c(".fw-mail-optin").trigger("change")),e.optin_success&&c(".fw-mail-optin-success").val(e.optin_success),e.replacements&&c(".fw-mail-string-replacement").prop("checked","on"===e.replacements)}}(e.wizard.settings),c(".fw-button-save").on("click",h),c(window).on("keydown",function(e){if((e.ctrlKey||e.metaKey)&&"s"==String.fromCharCode(e.which).toLowerCase())return e.preventDefault(),h(),!1}),c(window).scroll(function(){c(".nav-tab-wrapper").position().top+c(".nav-tab-wrapper").height()+9<c(this).scrollTop()?c(a).addClass("fw-sticky"):c(a).removeClass("fw-sticky")}),i.on("click",".postbox .handlediv",function(){c(this).closest(".postbox").toggleClass("closed")}),i.on("click",".fw-radio-add",function(){var e=c(this).prev(".fw-radio-option-container"),i=d("",e.children(".fw-radio-option-element").length);c(i).appendTo(e),y(e)}),i.on("click",".fw-remove-radio-option",function(){n("remove on click");var e=c(this),i=e.closest(".fw-radio-option-container");e.closest(".fw-radio-option-element").remove(),y(i)}),i.on("keydown",".fw-numeric-minimum",j),i.on("keydown",".fw-numeric-maximum",j),i.on("click",".fw-media-select",A),i.on("click",".fw-remove-step",q),k(),g(),S(),E(),function(e){e.find(".fw-media-element").each(function(){if("0"!==c(this).val().toString()){var i=c(this).parent();wp.media.attachment(c(this).val()).fetch({success:function(e){T(i,e.attributes)}})}})}(i),"undefined"!=typeof msfp&&msfp&&setupConditionals(-1),c("#fw-nav-settings").on("click",function(e){c("#fw-nav-steps").toggleClass("nav-tab-active"),c("#fw-nav-settings").toggleClass("nav-tab-active"),c(l).hide(),c(a).hide(),D(".fw-mail-replyto","no-reply"),D(".fw-mail-usercopy","no-usercopy"),D(".fw-mail-optin","no-optin"),c(".fw-mail-settings-container").show()}),c("#fw-nav-steps").on("click",function(e){c("#fw-nav-steps").toggleClass("nav-tab-active"),c("#fw-nav-settings").toggleClass("nav-tab-active"),c(".fw-mail-settings-container").hide(),c(l).show(),c(a).show()}),c("#fw-elements-modal").dialog({dialogClass:"wp-dialog",modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{Close:function(){c(this).dialog("close")}}})}catch(e){r(e)}})}(jQuery);